<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="CodeFuseä»‹ç»ä¸»è¦åŠŸèƒ½">
<meta name="author" content="codefuse-ai">

<title>æŸ¥è¯¢è¯­è¨€ä»‹ç» Â· CodeFuse-AI</title>

<link rel="canonical" href="/docs/codefuse-query-godellanguage-zh/">









<link rel="stylesheet" href="/scss/base.css" integrity="">



<link rel="stylesheet" href="/scss/theme/default.css" integrity="">



<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/icon/favicon.ico">
<link rel="icon" href="/img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="/img/icon/icon-180.png" sizes="180x180">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-xxxx"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-xxxx');
</script>


  
  

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css">
  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="/">CodeFuse-AI</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          
          <li role="menuitem"><a href="/docs/codefuse-query-godellanguage/">English</a></li>
          
          <li role="menuitem"><a href="/docs/codefuse-query-godellanguage-zh/">ä¸­æ–‡</a></li>
          
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="/" ><i class='icon icon-home'></i>Home</a></li>
        
          
          <li><a href="/docs"  class="active"><i class='icon icon-book'></i>Overview</a></li>
        
          
          <li><a href="/muagent" ><i class='icon icon-book'></i>MuAgent</a></li>
        
          
          <li><a href="/contribution" ><i class='icon icon-book'></i>Contribution</a></li>
        
      </ul>
    </nav>
  </div>

  
  <div id="site-header-search"></div>
</header>
    
<div id="site-main-content-wrapper">
  
  
    <aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">ğŸ“– CodeFuse-AI æ•´ä½“ä»‹ç»</strong>
          
          <a class="sidebar-link " href="/docs/%E6%A6%82%E8%A7%88/">
            
              æ¦‚è§ˆ
            
          </a>

        <strong class="sidebar-section">ğŸ“– CodeFuse-AI æ¨¡å—</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-query-zh/">
            
              CodeFuse-Query
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-zh/">
            
              MFTCoder
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-mft-vlm-zh/">
            
              CodeFuse-MFT-VLM
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/test-agent-zh/">
            
              Test-Agent
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-zh/">
            
              CodeFuse-ModelCache
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-chatbot-zh/">
            
              CodeFuse-ChatBot
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-eval-zh/">
            
              CodeFuse-DevOps-Eval
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model-zh/">
            
              CodeFuse-DevOps-Model
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-evalution-zh/">
            
              CodeFuse-Evalution
            
          </a>

        <strong class="sidebar-section">CodeFuse-Query</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-query-introduction-zh/">
            
              åŸºæœ¬ä»‹ç»
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        
          
          <a class="sidebar-link current" href="/docs/codefuse-query-godellanguage-zh/">
            
              æŸ¥è¯¢è¯­è¨€ä»‹ç»
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-toolchain-zh/">
            
              VSCodeæ’ä»¶
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-usercase-zh/">
            
              ç”¨æˆ·æ¡ˆä¾‹
            
          </a>

        <strong class="sidebar-section">MFTCoder</strong>
          
          <a class="sidebar-link " href="/docs/mftcoder-introduction-zh/">
            
              åŸºæœ¬ä»‹ç»
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-quickstart-zh/">
            
              å¿«é€Ÿä½¿ç”¨
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-accelerate-zh/">
            
              Accelerate &#43; DeepSpeed/FSDP æ¡†æ¶ç¯‡
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-atorch-zh/">
            
              Atorchæ¡†æ¶ç¯‡
            
          </a>

        <strong class="sidebar-section">CodeFuse-MFT-VLM</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-mft-vlm-quickstart-zh/">
            
              å¿«é€Ÿä½¿ç”¨
            
          </a>

        <strong class="sidebar-section">ğŸŒ± Test Agent</strong>
          
          <a class="sidebar-link " href="/docs/test-agent-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        <strong class="sidebar-section">ğŸŒ± CodeFuse-ModelCache</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-feature-zh/">
            
              åŠŸèƒ½ç‰¹æ€§
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-config-zh/">
            
              æœ€ä½³é…ç½®
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-release-zh/">
            
              ç‰ˆæœ¬è®°å½•
            
          </a>

        <strong class="sidebar-section">ğŸŒ± CodeFuse-ChatBot</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-chatbot-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/%E5%90%AF%E5%8A%A8%E6%98%8E%E7%BB%86/">
            
              å¯åŠ¨æ˜ç»†
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/%E6%9C%AC%E5%9C%B0%E7%A7%81%E6%9C%89%E5%8C%96%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%8F%A3%E6%8E%A5%E5%85%A5/">
            
              æœ¬åœ°ç§æœ‰åŒ–&amp;å¤§æ¨¡å‹æ¥å£æ¥å…¥
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/chatbot-%E6%8A%80%E6%9C%AF%E8%B7%AF%E7%BA%BF/">
            
              ChatBot æŠ€æœ¯è·¯çº¿
            
          </a>

        <strong class="sidebar-section">ğŸŒ± CodeFuse-DevOps-Model</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model-train-zh/">
            
              è®­ç»ƒè§£æ
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model-quickstart-zh/">
            
              å¿«é€Ÿä½¿ç”¨
            
          </a>

        <strong class="sidebar-section">ğŸŒ± CodeFuse-DevOps-Eval</strong>
          
          <a class="sidebar-link " href="/docs/%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/">
            
              æ•°æ®ä»‹ç»
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-eval-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        <strong class="sidebar-section">ğŸŒ± CodeFuse-evalution</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-evalution-quickstart-zh/">
            
              å¿«é€Ÿå¼€å§‹
            
          </a>

        
  </div>
</aside>
  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  
</nav>
      <header id="article-header">
  <h1>æŸ¥è¯¢è¯­è¨€ä»‹ç»</h1>
</header>
      <div id="article-content">
        
        
        <h1 id="gÃ¶delscript-æŸ¥è¯¢è¯­è¨€">GÃ¶delScript æŸ¥è¯¢è¯­è¨€</h1>
<h2 id="ç›®å½•">ç›®å½•</h2>
<ul>
<li><a href="#g%C3%B6delscript-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E8%AF%AD%E6%B3%95">GÃ¶delScript åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•</a>
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">ç®€ä»‹</a></li>
<li><a href="#%E5%9F%BA%E6%9C%AC%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90">åŸºæœ¬ç¨‹åºæ„æˆ</a></li>
<li><a href="#%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%BC%96%E8%AF%91%E5%99%A8%E5%86%85%E5%BB%BA%E5%87%BD%E6%95%B0">åŸºç¡€ç±»å‹å’Œç¼–è¯‘å™¨å†…å»ºå‡½æ•°</a></li>
<li><a href="#%E5%87%BD%E6%95%B0">å‡½æ•°</a></li>
<li><a href="#%E8%AF%AD%E5%8F%A5">è¯­å¥</a></li>
<li><a href="#schema">Schema</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93">æ•°æ®åº“</a></li>
<li><a href="#trait">Trait</a></li>
<li><a href="#import">Import</a></li>
<li><a href="#query">Query</a></li>
<li><a href="#ungrounded-error-%E6%9C%AA%E8%B5%8B%E5%80%BC%E6%9C%AA%E7%BB%91%E5%AE%9A%E9%94%99%E8%AF%AF">Ungrounded Error: æœªèµ‹å€¼/æœªç»‘å®šé”™è¯¯</a></li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E7%A4%BA%E4%BE%8B">æŸ¥è¯¢ç¤ºä¾‹</a>
<ul>
<li><a href="#java">Java</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#javascript">JavaScript</a></li>
<li><a href="#xml">XML</a></li>
<li><a href="#go">Go</a></li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E8%B0%83%E8%AF%95%E5%92%8C%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7">æŸ¥è¯¢è°ƒè¯•å’Œä¼˜åŒ–æŠ€å·§</a>
<ul>
<li><a href="#schema-%E4%BC%A0%E5%8F%82%E5%AF%BC%E8%87%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E8%BF%87%E5%A4%A7">Schema ä¼ å‚å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</a></li>
<li><a href="#%E5%A4%9A%E5%B1%82-for-%E5%AF%BC%E8%87%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E8%BF%87%E5%A4%A7">å¤šå±‚ for å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</a></li>
<li><a href="#%E4%B8%8D%E8%A6%81%E6%BB%A5%E7%94%A8inline%E5%BF%85%E9%A1%BB%E7%94%A8inline%E7%9A%84%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5">ä¸è¦æ»¥ç”¨<code>@inline</code></a></li>
</ul>
</li>
<li><a href="#%E5%9C%A8%E6%9C%AC%E6%9C%BA%E4%BD%BF%E7%94%A8%E6%9F%A5%E8%AF%A2%E8%84%9A%E6%9C%AC%E6%B5%81%E7%A8%8B">åœ¨æœ¬æœºä½¿ç”¨æŸ¥è¯¢è„šæœ¬æµç¨‹</a></li>
</ul>
<h2 id="gÃ¶delscript-åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•">GÃ¶delScript åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•</h2>
<h3 id="ç®€ä»‹">ç®€ä»‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">hello</span><span class="p">(</span><span class="n">greeting</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;hello world!&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">hello</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>GÃ¶delScript å³ GÃ¶del æŸ¥è¯¢è¯­è¨€ã€‚GÃ¶delScript æ˜¯ CodeQuery ç”¨äºæŸ¥è¯¢å’Œæ•°æ®å¤„ç†çš„é¢†åŸŸä¸“ç”¨è¯­è¨€ (DSL)ã€‚GÃ¶delScript ä½¿ç”¨äº†ç±» Rust çš„è¯­æ³•ï¼Œæä¾›äº†ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ã€æ–¹ä¾¿å¿«æ·çš„ç±»å‹æ¨å¯¼ã€æ™ºèƒ½å‹å¥½çš„é”™è¯¯æç¤ºä¿¡æ¯ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<p>GÃ¶delScript ç¼–è¯‘å™¨ä¸»è¦åº”ç”¨åœºæ™¯ä¸ºï¼š</p>
<ol>
<li>é¢å‘ç”¨æˆ·ç¼–å†™ç®€å•æˆ–å¤æ‚æŸ¥è¯¢ï¼Œæä¾›æ›´ä¾¿æ·çš„å†™æ³•ï¼Œæé«˜ç¼–å†™æŸ¥è¯¢çš„æ•ˆç‡ï¼›</li>
<li>æä¾›ä¸¥æ ¼ç±»å‹æ£€æŸ¥ä¸ç±»å‹æ¨å¯¼ï¼Œç»™äºˆæ›´æ™ºèƒ½çš„ä»£ç ä¿®æ”¹æç¤ºï¼›</li>
<li>æä¾›ä¸¥æ ¼çš„ <a href="#ungrounded-error-%E6%9C%AA%E8%B5%8B%E5%80%BC%E6%9C%AA%E7%BB%91%E5%AE%9A%E9%94%99%E8%AF%AF">ungrounded(æœªèµ‹å€¼/æœªç»‘å®š)</a> æ£€æµ‹ï¼Œé¿å…è§¦å‘ SoufflÃ© Ungrounded Errorï¼›</li>
<li>Language Server ä»¥åŠ IDE Extension æ”¯æŒã€‚</li>
</ol>
<h3 id="åŸºæœ¬ç¨‹åºæ„æˆ">åŸºæœ¬ç¨‹åºæ„æˆ</h3>
<h4 id="ç¨‹åºç»“æ„">ç¨‹åºç»“æ„</h4>
<p>GÃ¶delScript ç¨‹åºå¯èƒ½åŒ…å«:</p>
<ul>
<li><a href="#import">æ¨¡å—å’Œç¬¦å·å¼•ç”¨</a></li>
<li><a href="#schema">Schema ç±»å‹å£°æ˜</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93">æ•°æ®åº“ç±»å‹å£°æ˜</a></li>
<li><a href="#trait">Trait å£°æ˜</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0">Schema æ–¹æ³•å®ç°</a></li>
<li><a href="#%E5%87%BD%E6%95%B0">å‡½æ•°å£°æ˜å’Œå®ç°</a></li>
<li><a href="#query">Query å£°æ˜</a></li>
</ul>
<p>åŒ…å«ä»¥ä¸Šæ‰€æœ‰ç»„æˆå†…å®¹çš„æ ·ä¾‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1">// åŒ…å¼•å…¥/ç¬¦å·å¼•å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w"> </span><span class="c1">// å¼•å…¥æ‰€æœ‰ç¬¦å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">JavaDB</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">}</span><span class="w"> </span><span class="c1">// é€‰æ‹©æ€§å¼•å…¥ç¬¦å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å‡½æ•°å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;example.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// schema å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// database å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">database</span><span class="w"> </span><span class="n">NewDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">file</span>: <span class="o">*</span><span class="n">File</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// trait å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">trait</span><span class="w"> </span><span class="n">FileTrait</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// impl trait for
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">FileTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// impl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">all</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">2</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">query</span><span class="w"> </span><span class="n">get_all_anno</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Annotation</span><span class="w"> </span><span class="n">anno</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Annotation</span><span class="p">(</span><span class="n">default_db</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">anno</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ³¨é‡Š">æ³¨é‡Š</h4>
<p>GÃ¶delScript é‡‡ç”¨ç±» C è¯­è¨€çš„æ³¨é‡Šæ–¹å¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// å•è¡Œæ³¨é‡Š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">* 1. å¤šè¡Œæ³¨é‡Š
</span></span></span><span class="line"><span class="cl"><span class="cm">* 2. å¤šè¡Œæ³¨é‡Š
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span></code></pre></div><h4 id="main-å‡½æ•°"><code>main</code> å‡½æ•°</h4>
<p>GÃ¶delScript æŸ¥è¯¢è„šæœ¬å¯ä»¥åŒ…å«<code>main</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°æ— è¿”å›å€¼ã€‚åœ¨ä¸å®ç°<code>main</code>å‡½æ•°ï¼Œä¸”æ²¡æœ‰å†™ query å£°æ˜çš„æƒ…å†µä¸‹ï¼Œç¨‹åºä¸ä¼šè¾“å‡ºã€‚</p>
<p>æ›´å¤šè¯¦ç»†å†…å®¹è¯·çœ‹ <a href="#g%C3%B6delscript-main-%E5%87%BD%E6%95%B0">main å‡½æ•°</a>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">query_1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">query_2</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="åŸºç¡€ç±»å‹å’Œç¼–è¯‘å™¨å†…å»ºå‡½æ•°">åŸºç¡€ç±»å‹å’Œç¼–è¯‘å™¨å†…å»ºå‡½æ•°</h3>
<p>GÃ¶delScript åŒ…å«åŸºç¡€ç±»å‹<code>int</code> <code>string</code>ï¼Œ<code>bool</code>å±äºåŸºç¡€ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½ä½œä¸ºå€¼å­˜å‚¨ã€‚</p>
<h4 id="intç±»å‹-native-å‡½æ•°"><code>int</code>ç±»å‹ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>pow</td>
<td>(int, int) -&gt; int</td>
<td>ä¹˜æ–¹ã€‚å‚æ•°åªèƒ½éè´Ÿæ•°ã€‚</td>
</tr>
<tr>
<td>rem</td>
<td>(int, int) -&gt; int</td>
<td>å–ä½™ã€‚</td>
</tr>
<tr>
<td>bitand</td>
<td>(int, int) -&gt; int</td>
<td>æŒ‰ä½ä¸ã€‚</td>
</tr>
<tr>
<td>bitor</td>
<td>(int, int) -&gt; int</td>
<td>æŒ‰ä½æˆ–ã€‚</td>
</tr>
<tr>
<td>bitxor</td>
<td>(int, int) -&gt; int</td>
<td>æŒ‰ä½å¼‚æˆ–ã€‚</td>
</tr>
<tr>
<td>bitnot</td>
<td>(int) -&gt; int</td>
<td>æŒ‰ä½éã€‚</td>
</tr>
<tr>
<td>neg</td>
<td>(int) -&gt; int</td>
<td>ç®—æœ¯å–åã€‚</td>
</tr>
<tr>
<td>to_string</td>
<td>(int) -&gt; string</td>
<td>è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td>add</td>
<td>(int, int) -&gt; int</td>
<td>+</td>
</tr>
<tr>
<td>sub</td>
<td>(int, int) -&gt; int</td>
<td>-</td>
</tr>
<tr>
<td>mul</td>
<td>(int, int) -&gt; int</td>
<td>*</td>
</tr>
<tr>
<td>div</td>
<td>(int, int) -&gt; int</td>
<td>/</td>
</tr>
<tr>
<td>eq</td>
<td>(int, int) -&gt; bool</td>
<td>=</td>
</tr>
<tr>
<td>ne</td>
<td>(int, int) -&gt; bool</td>
<td>!=</td>
</tr>
<tr>
<td>gt</td>
<td>(int, int) -&gt; bool</td>
<td>&gt;</td>
</tr>
<tr>
<td>ge</td>
<td>(int, int) -&gt; bool</td>
<td>&gt;=</td>
</tr>
<tr>
<td>lt</td>
<td>(int, int) -&gt; bool</td>
<td>&lt;</td>
</tr>
<tr>
<td>le</td>
<td>(int, int) -&gt; bool</td>
<td>&lt;=</td>
</tr>
<tr>
<td>to_set</td>
<td>(int) -&gt; *int</td>
<td>è½¬ä¸ºé›†åˆç±»å‹ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="stringç±»å‹-native-å‡½æ•°"><code>string</code>ç±»å‹ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>len</td>
<td>(string) -&gt; int</td>
<td>è·å–å­—ç¬¦ä¸²é•¿åº¦ã€‚</td>
</tr>
<tr>
<td>substr</td>
<td>(string, int, int) -&gt; string</td>
<td>é€šè¿‡åˆå§‹indexå’Œlengthæ¥æˆªå–å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td>contains</td>
<td>(string, string) -&gt; bool</td>
<td>åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦è¢«åŒ…å«åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­ã€‚</td>
</tr>
<tr>
<td>matches</td>
<td>(string, string) -&gt; bool</td>
<td>åˆ¤æ–­æ­£åˆ™å­—ç¬¦ä¸²æ˜¯å¦å®Œå…¨åŒ¹é…å½“å‰å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td>get_regex_match_result</td>
<td>(string, string, int) -&gt; string</td>
<td>è·å–è¢«æ­£åˆ™å­—ç¬¦ä¸²å®Œå…¨åŒ¹é…å½“å‰å­—ç¬¦ä¸²æ—¶çš„æŸä¸€ä¸ªæ•è·ç»“æœï¼Œè¯¥ç»“æœç”±ç¬¬äºŒä¸ªå‚æ•°ï¼ˆintï¼‰ç¡®å®šã€‚å¦‚ &ldquo;abcdef&rdquo;.get_regex_match_result(&ldquo;a(.*)f&rdquo;, 1) çš„ç»“æœæ˜¯ &ldquo;bcde&rdquo;ã€‚</td>
</tr>
<tr>
<td>to_int</td>
<td>(string) -&gt; int</td>
<td>è½¬æ¢ä¸ºæ•´æ•°ã€‚</td>
</tr>
<tr>
<td>add</td>
<td>(string, string) -&gt; string</td>
<td>å­—ç¬¦ä¸²æ‹¼æ¥ã€‚</td>
</tr>
<tr>
<td>eq</td>
<td>(string, string) -&gt; bool</td>
<td>åˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰ã€‚</td>
</tr>
<tr>
<td>ne</td>
<td>(string, string) -&gt; bool</td>
<td>åˆ¤æ–­å­—ç¬¦ä¸²ä¸ç›¸ç­‰ã€‚</td>
</tr>
<tr>
<td>to_set</td>
<td>(string) -&gt; *string</td>
<td>è½¬ä¸ºé›†åˆç±»å‹ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="boolç±»å‹-native-å‡½æ•°"><code>bool</code>ç±»å‹ native å‡½æ•°</h4>
<p><code>bool</code>è™½ç„¶ä½œä¸ºåŸºç¡€ç±»å‹å­˜åœ¨ï¼Œä½†æ˜¯è¯¥ç±»å‹ä¸èƒ½ä½œä¸ºæ•°æ®å‚ä¸ä¸­é—´è®¡ç®—ï¼Œåªèƒ½ä½œä¸ºæ¡ä»¶ç»“æœã€‚</p>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>not</td>
<td>(bool) -&gt; bool</td>
<td>æ¡ä»¶å–åã€‚</td>
</tr>
<tr>
<td>and</td>
<td>(bool, bool) -&gt; bool</td>
<td>æ¡ä»¶ä¸ã€‚</td>
</tr>
<tr>
<td>or</td>
<td>(bool, bool) -&gt; bool</td>
<td>æ¡ä»¶æˆ–ã€‚</td>
</tr>
<tr>
<td>eq</td>
<td>(bool, bool) -&gt; bool</td>
<td>ç›¸ç­‰ã€‚</td>
</tr>
<tr>
<td>ne</td>
<td>(bool, bool) -&gt; bool</td>
<td>ä¸ç›¸ç­‰ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="ä½œç”¨äºé›†åˆçš„-native-å‡½æ•°">ä½œç”¨äºé›†åˆçš„ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>len</td>
<td>(*T) -&gt; int</td>
<td>è·å–æ•°æ®é›†åˆçš„æ•°é‡ã€‚</td>
</tr>
<tr>
<td>max</td>
<td>(*int) -&gt; int</td>
<td>æŸ¥æ‰¾æœ€å¤§å€¼ã€‚</td>
</tr>
<tr>
<td>min</td>
<td>(*int) -&gt; int</td>
<td>æŸ¥æ‰¾æœ€å°å€¼ã€‚</td>
</tr>
<tr>
<td>sum</td>
<td>(*int) -&gt; int</td>
<td>æ±‚å’Œã€‚</td>
</tr>
<tr>
<td>find</td>
<td>(*T0) -&gt; T1</td>
<td>ä»ä¸€ä¸ªé›†åˆä¸­ï¼Œé€šè¿‡ä¸»é”®æŸ¥æ‰¾æ•°æ®ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="å…¨å±€-native-å‡½æ•°">å…¨å±€ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>output</td>
<td>((&hellip;) -&gt; bool) -&gt; <null-type></td>
<td>è¾“å‡º query å†…å®¹ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="database-çš„-native-å‡½æ•°">database çš„ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>load</td>
<td>(string) -&gt; T</td>
<td>åŠ è½½ database ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="schema-çš„-native-å‡½æ•°">schema çš„ native å‡½æ•°</h4>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ç±»å‹</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>to<T></td>
<td>(self) -&gt; T</td>
<td>è½¬æ¢åˆ°å…¶ä»–ç±»å‹çš„ schemaï¼Œé‡‡ç”¨ duck type æ£€æµ‹ã€‚</td>
</tr>
<tr>
<td>is<T></td>
<td>(self) -&gt; bool</td>
<td>åˆ¤æ–­æ˜¯å¦å¯ä»¥æ˜¯å…¶ä»–ç±»å‹çš„ schemaï¼Œé‡‡ç”¨ duck type æ£€æµ‹ã€‚å¦‚æœè‡ªèº« schema æœ‰ä¸»é”®ï¼Œåˆ™åº•å±‚åªä¼šé€šè¿‡ä¸»é”®åˆ¤æ–­æ˜¯å¦å¯ä»¥æ˜¯å…¶ä»–ç±»å‹ã€‚</td>
</tr>
<tr>
<td>key_eq</td>
<td>(self, T) -&gt; bool</td>
<td>æ£€æŸ¥ä¸¤ä¸ª schema å®ä¾‹çš„ä¸»é”®æ˜¯å¦ç›¸ç­‰ã€‚</td>
</tr>
<tr>
<td>key_neq</td>
<td>(self, T) -&gt; bool</td>
<td>æ£€æŸ¥ä¸¤ä¸ª schema å®ä¾‹çš„ä¸»é”®æ˜¯å¦ä¸ç­‰ã€‚</td>
</tr>
</tbody>
</table>
<p>schema native å‡½æ•°å®ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">stmt</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">StatementParent</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stmt</span><span class="p">.</span><span class="n">is</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">convert</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">stmt</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">StatementParent</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="å‡½æ•°">å‡½æ•°</h3>
<h4 id="gÃ¶delscript-main-å‡½æ•°">GÃ¶delScript <code>main</code> å‡½æ•°</h4>
<p><code>main</code>å‡½æ•°æ˜¯ GÃ¶delScript ä¸­å”¯ä¸€ä¸å£°æ˜è¿”å›å€¼çš„å‡½æ•°ã€‚<code>main</code>å‡½æ•°åªå…è®¸ä½¿ç”¨<code>output</code>ï¼Œå…¶ä»–è¯­å¥ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼›å¤šæ¬¡ä½¿ç”¨<code>output(...)</code>å¯ä»¥è¾“å‡ºå¤šä¸ªæŸ¥è¯¢ç»“æœï¼ŒæŸ¥è¯¢ç»“æœä¼šåˆ†è¡¨æ˜¾ç¤ºï¼Œè¡¨åå³ä¸º<code>output</code>ä¸­è°ƒç”¨çš„æŸ¥è¯¢å‡½æ•°çš„å‡½æ•°åã€‚</p>
<h4 id="æŸ¥è¯¢å‡½æ•°">æŸ¥è¯¢å‡½æ•°</h4>
<p>æŸ¥è¯¢å‡½æ•°çš„è¿”å›å€¼ç±»å‹æ¨èä¸º<code>bool</code>ï¼Œéœ€è¦è¾“å‡ºæŸ¥è¯¢ç»“æœæ—¶ï¼Œéœ€è¦ä½¿ç”¨<code>output()</code>å‡½æ•°ã€‚</p>
<p>åœ¨<code>output()</code>ä¸­è°ƒç”¨çš„æŸ¥è¯¢å‡½æ•°ä¸å†æ˜¯å¸¸è§„æ€è·¯ä¸­çš„ç”¨ä¼ å‚è°ƒç”¨å‡½æ•°ã€‚å‚æ•°åˆ—è¡¨åœ¨æ­¤æ—¶ä¼šå˜åŒ–ä¸ºè¾“å‡ºè¡¨çš„è¡¨ç»“æ„ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªæŸ¥è¯¢å‡½æ•°çš„åº”ç”¨å®ä¾‹ï¼š</p>
<ol>
<li>
<p>å•è¡¨<code>output</code></p>
<p>å•è¡¨<code>output</code>ç‰¹æŒ‡åœ¨<code>main</code>å‡½æ•°ä¸­ï¼Œåªä½¿ç”¨ä¸€æ¬¡<code>output</code>æ¥è¾“å‡ºã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example</span><span class="p">())</span><span class="w"> </span><span class="c1">// æ­¤æ—¶å‚æ•°åˆ—è¡¨å˜ä¸ºè¾“å‡ºè¡¨ç»“æ„ï¼Œä¸éœ€è¦ä¼ å‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¯¹åº”çš„è¾“å‡ºè¡¨ç»“æ„ä¸º:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div></li>
<li>
<p>å¤šè¡¨<code>output</code></p>
<p>å¤šè¡¨<code>output</code>æ˜¯æŒ‡åœ¨<code>main</code>å‡½æ•°ä¸­ï¼Œä½¿ç”¨å¤šæ¬¡<code>output</code>æ¥è¾“å‡ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å‡ºæ•°æ®ä¼šé™„å¸¦å¯¹åº”çš„è¡¨åã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example0</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example1</span><span class="p">(</span><span class="n">a</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example0</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¯¹åº”çš„è¾“å‡ºè¡¨ç»“æ„ä¸º:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;example0&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;example1&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„ä¾‹å­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ äº†ä¸¤ç»„æ•°æ®å¹¶è¾“å‡ºã€‚åœ¨ä¸‹åˆ—ä»£ç ä¸­ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ol>
<li>
<p>GÃ¶delScript ä¸­ï¼Œå¸ƒå°”å€¼å¯ä»¥ä½¿ç”¨<code>true</code>å’Œ<code>false</code>å…³é”®å­—ã€‚</p>
</li>
<li>
<p><code>=</code>ç¬¦å·åœ¨ GÃ¶delScript ä¸­æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ç¬¦å·ï¼Œä¸èƒ½ç”¨å¸¸è§„çš„ç¼–ç¨‹è¯­è¨€çš„æ€è·¯æ¥ç†è§£ã€‚GÃ¶delScript æ˜¯ä¸€ç§ Datalog è¯­è¨€ã€‚åœ¨è¿™é‡Œï¼Œ<code>=</code>ç¬¦å·åŒæ—¶å…·å¤‡ä¸¤ç§è¯­ä¹‰ï¼Œä¸€ä¸ªæ˜¯ <strong>èµ‹å€¼</strong> ä¸€ä¸ªæ˜¯ <strong>åˆ¤ç­‰</strong>ã€‚è¯¦æƒ…å¯çœ‹<a href="#%E8%B5%8B%E5%80%BC%E5%92%8C%E5%88%A4%E7%AD%89%E8%BF%90%E7%AE%97%E7%AC%A6"><code>=</code>è¿ç®—ç¬¦</a>ã€‚</p>
</li>
<li>
<p>åœ¨è¿™ä¸ªä¾‹å­çš„æ¡ä»¶è¯­å¥ä¸­ï¼Œ<code>a</code>å’Œ<code>b</code>å‡ä½¿ç”¨äº†<code>=</code>çš„èµ‹å€¼è¯­ä¹‰ï¼Œå› ä¸º<code>int</code>å’Œ<code>string</code>ç±»å‹å‚æ•°åœ¨å‡½æ•°ä½“ä¸­è¢«è®¤ä¸ºæ˜¯<code>ungrounded(æœªèµ‹å€¼/æœªç»‘å®š)</code>ï¼Œå¿…é¡»è¦è¢«èµ‹å€¼æ‰èƒ½ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><code>=</code>èµ‹å€¼è¯­å¥çš„è¿”å›å€¼æ˜¯<code>true</code>ã€‚</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// = ç¬¦å·åŒæ—¶å…·æœ‰èµ‹å€¼å’Œæ¯”è¾ƒçš„åŠŸèƒ½ï¼Œå–å†³äºæ­¤æ—¶çš„å·¦å€¼æ˜¯å¦å·²ç»â€œè¢«èµ‹å€¼â€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// è¿™é‡Œçš„ a å’Œ b æ‰€ç”¨çš„ = ç¬¦å·å‡æ˜¯èµ‹å€¼è¯­ä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;1&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// GÃ¶delScript ä½¿ç”¨å…³é”®å­— true å’Œ false æ¥è¡¨ç¤ºå¸ƒå°”å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;2&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>é¢„æœŸçš„è¾“å‡ºç»“æœåº”è¯¥ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;2&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><h4 id="æ™®é€šå‡½æ•°">æ™®é€šå‡½æ•°</h4>
<p>æ™®é€šå‡½æ•°ç”¨äºå°è£…ä¸€äº›å¤æ‚è¿‡ç¨‹ï¼Œè¿™äº›å‡½æ•°å¿…é¡»è¦æœ‰æ˜ç¡®çš„è¿”å›ç±»å‹ã€‚
å…¶ä¸­è¿”å›ç±»å‹å¯ä»¥å­˜åœ¨ä¸¤ç§æƒ…å†µ:</p>
<ol>
<li>å•ä¸ªè¿”å›å€¼ï¼Œç®­å¤´åé¢å£°æ˜è¿”å›å€¼ç±»å‹ã€‚</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getFile</span><span class="p">(</span><span class="n">c</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ol start="2">
<li>è¿”å›é›†åˆï¼Œç®­å¤´åé¢çš„è¿”å›å€¼ç±»å‹å‰éœ€è¦åŠ ä¸Š<code>*</code>ä»¥è¡¨æ˜å…¶è¿”å›çš„æ˜¯ä¸€ä¸ªé›†åˆã€‚</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAllFiles</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>ä¸€èˆ¬æƒ…å†µä¸‹è¦æ±‚å•è¿”å›å€¼ä½¿ç”¨<code>return</code>è¯­å¥ï¼Œè€Œå¤šè¿”å›å€¼/è¿”å›é›†åˆä½¿ç”¨<code>yield</code>è¯­å¥ã€‚
å®é™…ä½¿ç”¨ä¸­ï¼Œç”±äº GÃ¶delScript åº•å±‚ä½¿ç”¨ Datalog å¼•æ“ï¼Œæ•…ä»»ä½•çš„è¿ç®—éƒ½æ˜¯åŸºäºé›†åˆçš„ï¼Œå•è¿”å›å€¼å®é™…ä¸Šä»…ä»…æ„å‘³ç€è¿”å›çš„é›†åˆå¯èƒ½åªåŒ…å«ä¸€ä¸ªæ•°æ®ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½åŒ…å«å¤šä¸ªæ•°æ®ã€‚</p>
<h3 id="è¯­å¥">è¯­å¥</h3>
<h4 id="for-è¯­å¥ä»é›†åˆä¸­å£°æ˜å˜é‡">for è¯­å¥ï¼šä»é›†åˆä¸­å£°æ˜å˜é‡</h4>
<p>GÃ¶delScript ä½¿ç”¨<code>for</code>å…³é”®å­—å’Œç±»ä¼¼å¾ªç¯è¯­å¥çš„è¯­æ³•æ¥ä»é›†åˆä¸­å£°æ˜å˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllFiles</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å…¶ä¸­<code>f: File</code>ï¼Œå†’å·åé¢è·Ÿç€çš„æ˜¯<code>f</code>çš„ç±»å‹ï¼Œå¯çœç•¥ã€‚
<code>for</code>è¯­å¥ä¸­å…è®¸ç›´æ¥å®šä¹‰å¤šä¸ªå˜é‡ï¼Œåé¢å®šä¹‰çš„å˜é‡åœ¨åˆå§‹åŒ–æ—¶å¯ä½¿ç”¨åŒä¸€è¯­å¥ä¸­åœ¨å®ƒå‰é¢å®šä¹‰çš„æ‰€æœ‰å˜é‡:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllFiles</span><span class="p">(),</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">getAllPaths</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="let-è¯­å¥å£°æ˜å•ä¸€å˜é‡">let è¯­å¥ï¼šå£°æ˜å•ä¸€å˜é‡</h4>
<p>GÃ¶delScript ä½¿ç”¨ <code>let</code>å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå•ä¸€/ä¸­é—´å˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="kd">let</span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å…¶ä¸­<code>f: File</code>ï¼Œå†’å·åé¢çš„ç±»å‹å¯çœç•¥ã€‚
<code>let</code>è¯­å¥ä¸­å…è®¸ç›´æ¥å®šä¹‰å¤šä¸ªå˜é‡ï¼Œåé¢å®šä¹‰çš„å˜é‡åœ¨åˆå§‹åŒ–æ—¶å¯ä½¿ç”¨åŒä¸€è¯­å¥ä¸­åœ¨å®ƒå‰é¢å®šä¹‰çš„æ‰€æœ‰å˜é‡:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="kd">let</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="if-è¯­å¥">if è¯­å¥</h4>
<p>GÃ¶delScript çš„æ¡ä»¶è¯­å¥ä¸è®¸å¤šè¿‡ç¨‹å¼ç¨‹åºè¯­è¨€ç±»ä¼¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;util&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;com&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>æ¡ä»¶å¯ä»¥ä½¿ç”¨è¿™äº›é€»è¾‘è¿ç®—ç¬¦è¿›è¡Œè¿æ¥ï¼š<code>!</code>å–åï¼Œ<code>||</code>æˆ–ï¼Œ<code>&amp;&amp;</code>ä¸ã€‚</p>
<p>æ¡ä»¶ä¸­çš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼š<code>&gt;</code>å¤§äºï¼Œ<code>&lt;</code>å°äºï¼Œ<code>&gt;=</code>å¤§äºç­‰äºï¼Œ<code>&lt;=</code>å°äºç­‰äºï¼Œ<code>=</code>ç­‰äºæˆ–è€…èµ‹å€¼ï¼Œ<code>!=</code>ä¸ç­‰äºã€‚</p>
<p>å¸¸è§„ç®—æœ¯è¿ç®—å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¿ç®—ç¬¦ï¼š<code>+</code>åŠ æ³•ï¼Œ<code>-</code>å‡æ³•/å–è´Ÿï¼Œ<code>*</code>ä¹˜æ³•ï¼Œ<code>/</code>é™¤æ³•ã€‚</p>
<h5 id="èµ‹å€¼å’Œåˆ¤ç­‰è¿ç®—ç¬¦">èµ‹å€¼å’Œåˆ¤ç­‰è¿ç®—ç¬¦<code>=</code></h5>
<p><code>=</code>ç¬¦å·åœ¨ GÃ¶delScript ä¸­å…·æœ‰ä¸¤ç§ä¸åŒçš„è¯­ä¹‰ï¼šèµ‹å€¼å’Œåˆ¤ç­‰ï¼Œå…·ä½“çš„è¯­ä¹‰éœ€è¦åˆ†æƒ…å†µè¿›è¡Œè®¨è®º:</p>
<ol>
<li>
<p>èµ‹å€¼</p>
<p>èµ‹å€¼ä¸€èˆ¬å‡ºç°åœ¨<code>int</code> <code>string</code>è¿™ç±»åŸºç¡€ç±»å‹çš„å˜é‡å‚æ•°ä¸Šï¼Œè¿™ç±»å˜é‡ä½œä¸ºå‡½æ•°çš„å‚æ•°å‡ºç°æ—¶ï¼Œä¸€èˆ¬è¢«è®¤ä¸ºæ˜¯æœªèµ‹å€¼çš„ã€‚è€Œå…·æœ‰è¿™ç±»å˜é‡çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ï¼Œå®é™…ä¸Šæ˜¯ä½œä¸ºç­›é€‰æ¡ä»¶å­˜åœ¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è¿™é‡Œæ¯”è¾ƒåç›´è§‰ï¼Œåœ¨è¿‡ç¨‹å¼è¯­è¨€ä¸­ï¼Œè¿™é‡Œé€šå¸¸ä¼šè¢«è®¤ä¸ºæ˜¯åˆ¤æ–­ a == 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// ä½†æ˜¯åœ¨ datalog æ–¹è¨€ä¸­ï¼Œdatalog çš„æ¯ä¸ªå‡½æ•°å®é™…ä¸Šéƒ½æ˜¯åœ¨ç®—ä¸€ä¸ªä¸­é—´è¡¨ (view)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// æ‰€ä»¥è¿™ä¸ªå‡½æ•°æœ¬è´¨ä¸Šæ˜¯ç”Ÿæˆäº†ä¸€ä¸ª viewï¼Œæ•°æ®ä¸º [{&#34;a&#34;: 1}]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">// assign a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è¿™é‡Œçœ‹ä¼¼æ˜¯åœ¨é€šè¿‡ä¼ å‚è®© a = 2ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// example() è‡ªå·±ä¼šè¿”å› view: [{&#34;a&#34;: 1}]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// ç„¶åé€šè¿‡ a = 2 æ¥çº¦æŸç»“æœï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰æ‹¿åˆ°ä»»ä½•ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// æ‰€ä»¥è¿”å›äº† false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">example</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>åˆ¤ç­‰</p>
<p>å¯¹äº schema ç±»å‹æ¥è¯´ï¼Œä»»ä½•ä¸€ä¸ª schema èƒŒåéƒ½æœ‰ä¸€ä¸ªå…¨é›†ï¼Œæ‰€ä»¥å‚æ•°åˆ—è¡¨ä¸­çš„ schema ç±»å‹ä¸€èˆ¬è¢«è®¤ä¸ºæ˜¯å·²ç»è¢«èµ‹å€¼çš„ã€‚å¯¹äºå·²ç»èµ‹å€¼çš„å˜é‡æ¥è¯´ï¼Œ<code>=</code>å°±æ˜¯åˆ¤ç­‰æ“ä½œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// å£°æ˜ schema
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å®ç° schema çš„æˆå‘˜å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è¿™é‡Œå®šä¹‰äº† schema A çš„å…¨é›†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">A</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">temp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">A</span>::<span class="n">__all__</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>åŒæ ·ï¼Œå¯¹äºä¸­é—´å£°æ˜çš„æœ‰åˆå§‹å€¼çš„<code>int</code>æˆ–è€…<code>string</code>ï¼Œ<code>=</code>ä¹Ÿæ˜¯åˆ¤ç­‰æ“ä½œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// assign a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// compare a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<h4 id="match-è¯­å¥">match è¯­å¥</h4>
<p>GÃ¶delScript å…è®¸å¯¹<code>int</code>å’Œ<code>string</code>ç±»å‹ç¼–å†™ match è¯­å¥ï¼Œmatch è¯­å¥æ˜¯ç±»ä¼¼ switch çš„å¤šæ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œmatch çš„æ¡ä»¶å¿…é¡»ä¸ºå­—é¢é‡:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">match</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">3</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="è¿”å›è¯­å¥">è¿”å›è¯­å¥</h4>
<p>GÃ¶delScript ä½¿ç”¨<code>return</code>å’Œ<code>yield</code>ã€‚<code>return</code>ç”¨äºå•ä¸ªè¿”å›å€¼çš„å‡½æ•°ï¼Œ<code>yield</code>ç”¨äºé›†åˆçš„è¿”å›ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">a</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">b</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kr">yield</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kr">yield</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kr">yield</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="schema">Schema</h3>
<p>Schema æ˜¯ GÃ¶delScript ä¸­çš„å¤æ‚æ•°æ®è¡¨çš„ç»“æ„ã€‚</p>
<h4 id="ç»“æ„å£°æ˜">ç»“æ„å£°æ˜</h4>
<p>GÃ¶delScript ä½¿ç”¨<code>schema</code>å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªè¡¨ç»“æ„:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¦‚æœæŸä¸ªå­—æ®µåœ¨æ•°æ®åº“ä¸­æ˜¯ä½œä¸ºä¸»é”®å­˜åœ¨çš„ï¼Œå¯ä»¥ä½¿ç”¨<code>@primary</code>æ³¨è§£æ¥è¡¨æ˜å…¶ä¸ºä¸»é”®:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>æœ‰ä¸»é”®çš„è¡¨ç»“æ„ä¼šä½¿å¾—æŸ¥è¯¢é€Ÿåº¦å¾—åˆ°æ˜¾è‘—æå‡ï¼Œæ‰€ä»¥å°½é‡ç»‘å®šä¸€ä¸ªä¸»é”®ï¼Œä¸»é”®åº”å°½é‡ä¸º</strong><code>**int**</code><strong>ç±»å‹ã€‚</strong></p>
<h4 id="æ–¹æ³•å®ç°">æ–¹æ³•å®ç°</h4>
<p>GÃ¶delScript ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥å£°æ˜å’Œå®ç°<code>schema</code>çš„ç›¸å…³æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é™æ€æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">fn</span> <span class="nf">f1</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æˆå‘˜æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ä¸º self
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">fn</span> <span class="nf">f2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="é™æ€æ–¹æ³•">é™æ€æ–¹æ³•</h5>
<p>é™æ€æ–¹æ³•ä¸éœ€è¦<code>self</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œ<code>ç±»å::æ–¹æ³•å(...)</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getSchemaName</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">t</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span>::<span class="n">getSchemaName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="æˆå‘˜æ–¹æ³•">æˆå‘˜æ–¹æ³•</h5>
<p>æˆå‘˜æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ä¸º<code>self</code>ï¼Œè¯¥å‚æ•°æ— éœ€å†™æ˜ç±»å‹ã€‚è¿™ç±»å‡½æ•°çš„è°ƒç”¨æ–¹å¼æ˜¯<code>å®ä¾‹å.å‡½æ•°å(...)</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">path</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="æ•°æ®åŠ è½½æ–¹æ³•-fn-__all__db">æ•°æ®åŠ è½½æ–¹æ³• <code>fn __all__(db)</code></h5>
<p><code>schema</code>å¯ä»¥åŒ…å«ä¸€ä¸ªç‰¹åˆ«çš„<strong>é™æ€æ–¹æ³•</strong>ï¼Œç”¨äºåŠ è½½å®ƒåœ¨æ•°æ®åº“ä¸­çš„æ•°æ®é›†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>è¿™ç§æ–¹æ³•å¿…é¡»åŒ…å«ç‰¹æ®Šæ³¨è§£<code>@data_constraint</code>ï¼Œè¡¨æ˜è¯¥æ–¹æ³•ä¸“ç”¨äºåŠ è½½ï¼Œå¦‚æœä¸å†™è¯¥æ³¨è§£ï¼Œåˆ™è¯¥æ–¹æ³•çš„è¿”å›ä¸º<strong>ç©ºé›†åˆ</strong>ã€‚è¯¥æ–¹æ³•è¿”å›ç±»å‹å¿…é¡»ä¸ºå…¶æœ¬èº«çš„é›†åˆã€‚</p>
<p>åŒ…å«äº†è¯¥æ–¹æ³•çš„<code>schema</code>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¯­æ³•ç³–æ¥è·å–å…¶å…¨é›†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">out</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç­‰ä»·äº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="è‡ªå®šä¹‰å…¨é›†æ–¹æ³•">è‡ªå®šä¹‰å…¨é›†æ–¹æ³•</h5>
<p><code>schema</code>å…è®¸ä½¿ç”¨ä¸åŒäº<code>__all__</code>åç§°çš„<strong>é™æ€æ–¹æ³•</strong>æ¥è¡¨æ˜ä¸€äº›é›†åˆä¹Ÿå­˜åœ¨äºè¯¥ç±»å‹çš„å…¨é›†ä¸­ã€‚è¯¥æ–¹æ³•ä¹Ÿå¿…é¡»åŒ…å«ç‰¹æ®Šæ³¨è§£<code>@data_constraint</code>ã€‚è¯¥æ–¹æ³•ä¸€èˆ¬ç”¨äºæ‰‹åŠ¨æ·»åŠ ä¸€äº›æ•°æ®åˆ°è¯¥ç±»å‹çš„å…¨é›†ä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">extend_example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1234567</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ„é€ åŒ¿åå®ä¾‹">æ„é€ åŒ¿åå®ä¾‹</h4>
<p>GÃ¶delScript å…è®¸ç”¨ä¸€ä¸ªç‰¹å®šè¯­æ³•ç”ŸæˆåŒ¿åå®ä¾‹ã€‚ç”ŸæˆåŒ¿åå®ä¾‹çš„å‰ææ˜¯è¯¥å®ä¾‹å­˜åœ¨äºè¯¥<code>schema</code>çš„å…¨é›†ä¸­ï¼Œé™¤éè¯¥ç”¨æ³•å‡ºç°åœ¨<code>@data_constraint</code>æ–¹æ³•ä¸­ï¼Œå¦åˆ™ç»“æœä¸ºç©ºã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¯¹åº”çš„åº”è¯¥ä½¿ç”¨å¦‚ä¸‹è¯­æ³•æ¥è¿›è¡ŒåŒ¿åå®ä¾‹çš„ç”Ÿæˆ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="s">&#34;first&#34;</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="schema-ç»§æ‰¿">Schema ç»§æ‰¿</h4>
<p>GÃ¶delScript ä¸­ï¼Œ<code>schema</code>ç»§æ‰¿éå¸¸ä¾¿æ·ï¼Œä½¿ç”¨æ ·ä¾‹å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="çˆ¶ç±»-field-ç»§æ‰¿">çˆ¶ç±» Field ç»§æ‰¿</h5>
<p>å­ç±»ä¼šé»˜è®¤å°†çˆ¶ç±»çš„æ‰€æœ‰ field ç»§æ‰¿ä¸‹æ¥ã€‚æ‰€ä»¥æ— éœ€æ‰‹åŠ¨é‡å†™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="çˆ¶ç±»-method-ç»§æ‰¿">çˆ¶ç±» Method ç»§æ‰¿</h5>
<p>å­ç±»ä¼šé»˜è®¤ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰ methodï¼Œé™¤äº†æ ‡æ³¨<code>@data_constraint</code>çš„æ–¹æ³•ã€‚æ‰€ä»¥æ— éœ€æ‰‹åŠ¨é‡å†™ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>__all__</code>æ–¹æ³•è¾ƒä¸ºç‰¹æ®Šï¼Œä¸ä¼šè¢«ç»§æ‰¿ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°ç¼–å†™<code>__all__</code>æ–¹æ³•ç¡®å®šç»§æ‰¿åçš„ schema çš„å…¨é›†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="method-override">Method Override</h5>
<p>å¦‚æœå­ç±»çš„å®ç°ä¸­å­˜åœ¨ä¸çˆ¶ç±»åŒåçš„æ–¹æ³•ï¼Œåˆ™çˆ¶ç±»çš„æ–¹æ³•ä¼šè¢«å­ç±»æ–¹æ³•<strong>è¦†ç›–</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;MyFile&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>æ­¤æ—¶<code>File::staticMethod</code>è¢«<code>MyFile::staticMethod</code>è¦†ç›–ï¼Œæ‰€ä»¥è°ƒç”¨å­ç±»çš„è¯¥æ–¹æ³•æ—¶ï¼Œè·å–çš„ç»“æœä¸º<code>&quot;MyFile&quot;</code>ã€‚</p>
<h3 id="æ•°æ®åº“">æ•°æ®åº“</h3>
<h4 id="æ•°æ®åº“å£°æ˜">æ•°æ®åº“å£°æ˜</h4>
<p>æ•°æ®åº“çš„å£°æ˜æ ¼å¼å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">DatabaseName</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// table_name å¯¹åº”çš„æ˜¯ db ä¸­çœŸå®çš„è¡¨å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// GodelSchemaType å¯¹åº”çš„æ˜¯å°†è¡¨æ•°æ®è¯»å…¥ godel åï¼Œå­˜å‚¨çš„å¯¹åº”çš„ schema
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">table_name</span><span class="w"> </span>: <span class="o">*</span><span class="n">GodelSchemaType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å†’å·å‰æ˜¯åŠ è½½çš„æ•°æ®åº“ä¸­çš„<strong>çœŸå®è¡¨å</strong>ï¼Œå†’å·åæ˜¯å…¶å¯¹åº”çš„<strong>æ•°æ®è¡¨æ ¼å¼</strong>ï¼Œå¿…é¡»ä¸º<code>schema</code>ç±»å‹ã€‚
ä¾‹å¦‚ db ä¸­å­˜åœ¨ä¸€å¼ è¡¨ï¼Œåå­—ä¸º<code>annotation</code>ï¼Œå¯¹åº”çš„<code>schema</code>æ˜¯<code>Annotation</code>ï¼Œå†™æ³•ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ä» db çš„ annotation è¡¨ä¸­è¯»å–æ•°æ®ï¼Œå­˜å…¥ Annotation ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">annotation</span><span class="w"> </span>: <span class="o">*</span><span class="n">Annotation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¦å¤–éœ€è¦ä¿è¯<code>Annotation</code>ç»“æ„å¿…é¡»å’Œè¡¨ç»“æ„ä¸€è‡´ï¼Œä¾‹å¦‚:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">Annotation</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="c1">// primaryæ³¨è§£è¡¨ç¤ºè¯¥å­—æ®µä¸ºä¸»é”®ï¼Œä¸€ä¸ªè¡¨ä¹Ÿå¯ä»¥æ²¡æœ‰ä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">content</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å°±å¿…é¡»è¦æ±‚<code>annotation</code>è¡¨ä¸­å¿…é¡»æœ‰<code>id</code>å’Œ<code>content</code>å­—æ®µï¼Œå¹¶ä¸”å­˜å‚¨ç±»å‹å¿…é¡»å¯¹åº”ã€‚</p>
<h4 id="æ•°æ®åº“åŠ è½½">æ•°æ®åº“åŠ è½½</h4>
<p>æ•°æ®åº“ç±»å‹æ‹¥æœ‰é™æ€æ–¹æ³•<code>(database)::load(filename: string)</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">loadDatabaseExample</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// load ä¸­ä¼ å…¥çš„ string ä¸º db çš„æ–‡ä»¶åï¼Œè€Œä¸éœ€è¦è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// å› ä¸º db çš„è·¯å¾„ä¼šåœ¨æ‰§è¡Œ godel æ—¶ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ•°æ®è¡¨è·å–">æ•°æ®è¡¨è·å–</h4>
<p>ä¸Šæ–‡ä¸­çš„ä¾‹å­ä¸­ï¼Œè¦æ‹¿åˆ°<code>annotation</code>è¡¨ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAnnotation</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Annotation</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// load ä¸­ä¼ å…¥çš„ string ä¸º db çš„æ–‡ä»¶åï¼Œè€Œä¸éœ€è¦è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// å› ä¸º db çš„è·¯å¾„ä¼šåœ¨æ‰§è¡Œ godel æ—¶ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç›´æ¥ä½¿ç”¨ db.field å°±å¯ä»¥æ‹¿åˆ°è¡¨æ•°æ®äº†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">anno</span>: <span class="nc">Annotation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">annotation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="trait">Trait</h3>
<h4 id="trait-å£°æ˜">Trait å£°æ˜</h4>
<p><code>trait</code>å£°æ˜è¯­æ³•å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">trait</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="impl-trait">Impl Trait</h4>
<p>å†™æ³•ä¸<code>impl</code>ç±»ä¼¼ï¼Œä½†æ˜¯å¿…é¡»è¦å°†<code>trait</code>ä¸­å£°æ˜çš„æ‰€æœ‰å‡½æ•°éƒ½å®ç°å‡ºæ¥ï¼Œå¦åˆ™æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">id</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">().</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="import">Import</h3>
<p>GÃ¶delScript ä½¿ç”¨<code>use</code>å…³é”®å­—æ¥å¼•å…¥å…¶ä»–æ–‡ä»¶çš„ç¬¦å·:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w"> </span><span class="c1">// å¼•ç”¨å…¨éƒ¨ç¬¦å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w"> </span><span class="c1">// å¼•ç”¨å•ä¸ªç¬¦å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="p">{</span><span class="n">XmlDB</span><span class="p">,</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">}</span><span class="w"> </span><span class="c1">// å¼•ç”¨å¤šä¸ªç¬¦å·
</span></span></span></code></pre></div><h4 id="æ¨¡å—å¼•ç”¨è§„åˆ™">æ¨¡å—å¼•ç”¨è§„åˆ™</h4>
<p>GÃ¶delScript åŒ…ç®¡ç†å™¨ä¼šåœ¨ä¼ å…¥å‚æ•°ä¸­å«æœ‰<code>-p {package dir path}</code>æ—¶å¯ç”¨ã€‚</p>
<p>åŒ…ç®¡ç†å™¨ä¼šå¯¹æ–‡ä»¶å¤¹ç»“æ„è¿›è¡Œè§£æï¼Œéå†å…¶ä¸­æ‰€æœ‰çš„<code>.gdl</code>åç¼€æ–‡ä»¶ã€‚åœ¨æ‹¿åˆ°æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„åï¼Œä¼šå°†è·¯å¾„æ˜ å°„åˆ°å¯¹åº”çš„åŒ…è·¯å¾„ã€‚å¦‚æœæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ä¸­å­˜åœ¨<code>-</code>ï¼Œæˆ–è€…è·¯å¾„ä¸­å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹åæˆ–è€…æ–‡ä»¶åæˆ–è€…<code>.</code>åè·Ÿéšçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ•°å­—ï¼Œ åˆ™è¯¥è·¯å¾„ä¸ä¼šè¢«åŒ…ç®¡ç†å™¨æ¥å—ï¼Œä½†æ˜¯åŒ…ç®¡ç†å™¨ä¸ä¼šå¯¹å…¶è¿›è¡ŒæŠ¥é”™ï¼Œåªè¿›è¡Œå¿½ç•¥å¤„ç†ã€‚</p>
<p>å¦‚æœæƒ³çŸ¥é“å¿½ç•¥äº†å“ªäº›è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨<code>-v</code>å‚æ•°ï¼ŒåŒ…ç®¡ç†å™¨åœ¨æœ‰è¯¥å‚æ•°çš„æƒ…å†µä¸‹ä¼šå°†å¿½ç•¥çš„è·¯å¾„ä½œä¸º<code>warning</code>æŠ¥å‡ºã€‚å¦‚æœæœ€ç»ˆæ˜ å°„çš„è·¯å¾„ä¸­ï¼Œå­˜åœ¨è·¯å¾„å†²çªçš„æƒ…å†µï¼Œé‚£ä¹ˆåŒ…ç®¡ç†å™¨ä¼šå°†å…¶ä½œä¸º<code>error</code>æŠ¥å‡ºå¹¶é€€å‡ºç¼–è¯‘è¿›ç¨‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">packages</span>:
</span></span><span class="line"><span class="cl">  <span class="nc">coref</span>::<span class="n">cfamily</span><span class="w">    </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">cfamily</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">go</span><span class="w">         </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">go</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">java</span><span class="w">       </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">javascript</span><span class="w"> </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">javascript</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">properties</span><span class="w"> </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">properties</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">python</span><span class="w">     </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">sql</span><span class="w">        </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">sql</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">xml</span><span class="w">        </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">modules</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+--</span><span class="n">coref</span><span class="w"> </span>-&gt; <span class="nc">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">xml</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">properties</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">properties</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">cfamily</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">cfamily</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">java</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">javascript</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">javascript</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">go</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">sql</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">sql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">+--</span><span class="n">python</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">python</span><span class="w">
</span></span></span></code></pre></div><h4 id="è·¯å¾„æ˜ å°„æ ·ä¾‹">è·¯å¾„æ˜ å°„æ ·ä¾‹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">|--</span><span class="w"> </span><span class="n">go</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+--</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">+--</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">a</span>::<span class="n">b</span><span class="w">
</span></span></span></code></pre></div><p>è¯¥æ ·ä¾‹ä¸­ï¼Œè·¯å¾„å‡ºç°å†²çª</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">|--</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">+--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">python</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="err">\</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="o">&gt;</span><span class="w"> </span><span class="err">å‡ºç°å†²çª</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">python</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">/</span><span class="w">
</span></span></span></code></pre></div><p>è¯¥æ ·ä¾‹ä¸­ï¼Œè·¯å¾„å­˜åœ¨ä¸åˆæ³•å­—ç¬¦</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="mf">0123.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="n">godel</span><span class="o">-</span><span class="n">lib</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">+--</span><span class="w"> </span><span class="n">js</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">lib</span><span class="o">-</span><span class="n">file</span><span class="p">.</span><span class="mf">123.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">0123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">^</span><span class="w"> </span><span class="err">ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºæ•°å­—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">my</span><span class="o">-</span><span class="n">godel</span><span class="o">-</span><span class="n">lib</span>::<span class="n">js</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">^</span><span class="w">     </span><span class="o">^</span><span class="w"> </span><span class="err">ä½¿ç”¨äº†</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="err">`</span><span class="w"> </span><span class="err">å­—ç¬¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">lib</span><span class="o">-</span><span class="n">file</span>::<span class="mi">123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="o">^</span><span class="w">      </span><span class="o">^</span><span class="w"> </span><span class="err">ä½¿ç”¨äº†ä¸€ä¸ªå­—ç¬¦ä¸ºæ•°å­—ï¼Œå¹¶ä¸”è·¯å¾„ä¸­åŒ…å«</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="err">`</span><span class="w">
</span></span></span></code></pre></div><h4 id="ç¬¦å·å†²çª">ç¬¦å·å†²çª</h4>
<p>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œéš¾å…ä¼šé‡åˆ°å¦‚ä¸‹çš„æƒ…å†µã€‚æ­¤æ—¶ç›´æ¥ä½¿ç”¨<code>File</code>ä¼šè¢«å‘ŠçŸ¥ç¬¦å·å†²çªï¼Œéœ€è¦æŒ‡å®šå…¶ä¸­ä¸€ä¸ªç¬¦å·ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyLoc</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">^^^^^^^^</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Error</span>: <span class="s">&#34;Location&#34;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">ambiguous</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">symbols</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="s">&#34;coref::java::Location, coref::xml::Location&#34;</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>ä¸å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼ŒGÃ¶delScriptå…è®¸é€šè¿‡å®Œæ•´è·¯å¾„çš„æ–¹å¼ç›´æ¥æŒ‡å®šä¸€ä¸ªç¬¦å·ï¼Œä½†æ˜¯è¯¥ç¬¦å·å¿…é¡»è¢«å¼•å…¥ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyLoc</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><p>å®Œæ•´è·¯å¾„ç¬¦å·å¯ä»¥è¢«ç”¨äºä»¥ä¸‹æƒ…å†µ:</p>
<ul>
<li>schema ç»§æ‰¿</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">JavaLocation</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>å‡½æ•°å‚æ•°å’Œè¿”å›å€¼</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">return_java_file</span><span class="p">(</span><span class="n">f</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>database å£°æ˜</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">MyDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">java_file</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">xml_file</span>: <span class="nc">coref</span>::<span class="n">xml</span>::<span class="n">File</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">java_loc</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">xml_loc</span>: <span class="nc">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>query åˆ—è¡¨ç±»å‹å£°æ˜</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">(</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>schema é™æ€æ–¹æ³•è°ƒç”¨</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">loc</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">(</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stmt</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stmt</span><span class="p">.</span><span class="n">is</span><span class="o">&lt;</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span></code></pre></div><h3 id="query">Query</h3>
<p>Query ç”¨äºè¿›è¡Œä¸€äº›ç®€å•çš„æŸ¥è¯¢ï¼Œç¼–å†™çš„ query ä¸€å®šä¼šè¢«è¾“å‡ºï¼Œå³ä½¿æ²¡æœ‰å£°æ˜<code>main</code>å‡½æ•°ã€‚Query çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="err">åå­—</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å˜é‡å</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">åˆå§‹å€¼</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å˜é‡å</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">åˆå§‹å€¼</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å˜é‡å</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">åˆå§‹å€¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="err">æ¡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w"> </span><span class="err">å€¼</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">è¾“å‡ºçš„åˆ—å</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å€¼</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">è¾“å‡ºçš„åˆ—å</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å€¼</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">è¾“å‡ºçš„åˆ—å</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">å€¼</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">è¾“å‡ºçš„åˆ—å</span><span class="w">
</span></span></span></code></pre></div><p>from åˆ—è¡¨ä¸­çš„å˜é‡å£°æ˜æ— éœ€åŠ ä¸Šç±»å‹æ ‡æ³¨ï¼Œç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œå¦å¤–æ­¤å¤„åˆå§‹åŒ–ä¸ä¼šä½¿ç”¨<code>=</code>å·ï¼Œè€Œæ˜¯<code>in</code>å…³é”®å­—ã€‚æ­¤å¤–ï¼Œselect åˆ—è¡¨ä¸­ï¼Œè¾“å‡ºçš„åˆ—åä¸èƒ½å’Œå‚ä¸è®¡ç®—çš„å˜é‡åå†²çªï¼Œä½†æ˜¯åˆ—åå¯ä»¥è¢«çœç•¥ã€‚è¢«çœç•¥çš„åˆ—åä¼šåœ¨è¾“å‡ºç»“æœæ—¶é‡‡å–éšæœºåå­—ï¼Œæ‰€ä»¥å°½é‡ä¸è¦çœç•¥ã€‚</p>
<p>ä¸‹é¢æ˜¯ç”¨ query è¯­æ³•ç¼–å†™çš„<code>hello world</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="n">hello_world</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s">&#34;hello world&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">greeting</span><span class="w">
</span></span></span></code></pre></div><p>ä¸Šé¢çš„ä»£ç ç­‰ä»·äºå¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">greeting</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;hello world&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">hello_world</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ ·ä¾‹å’Œç»„æˆç»“æ„">æ ·ä¾‹å’Œç»„æˆç»“æ„</h4>
<p>Query åŒ…å«äº†æŸ¥è¯¢åç§°ï¼Œ<code>from</code>åˆ—è¡¨ï¼Œ<code>where</code>ç­›é€‰æ¡ä»¶ï¼Œ<code>select</code>åˆ—è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">Interface</span><span class="p">,</span><span class="w"> </span><span class="n">JavaDB</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">query</span><span class="w"> </span><span class="n">class_method</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Callable</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">db</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Class</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getBelongedClass</span><span class="p">().</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">className</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">methodName</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">getSignature</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">methodSignature</span><span class="w">
</span></span></span></code></pre></div><h4 id="ç­‰ä»·ä»£ç ">ç­‰ä»·ä»£ç </h4>
<p>ä¸Šé¢çš„ä¾‹å­ç­‰ä»·äºå¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">Interface</span><span class="p">,</span><span class="w"> </span><span class="n">JavaDB</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">output</span><span class="p">(</span><span class="n">class_method</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">class_method</span><span class="p">(</span><span class="n">className</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodSignature</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">db</span><span class="p">()),</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getBelongedClass</span><span class="p">().</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">methodName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">methodSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="ungrounded-error-æœªèµ‹å€¼æœªç»‘å®šé”™è¯¯">Ungrounded Error: æœªèµ‹å€¼/æœªç»‘å®šé”™è¯¯</h3>
<p>GÃ¶delScript ä¼šå°†æœªä¸æ•°æ®ç»‘å®šçš„ç¬¦å·åˆ¤å®šä¸º<code>ungrounded(æœªèµ‹å€¼/æœªç»‘å®š)</code>ã€‚åŸºæœ¬åˆ¤å®šè§„åˆ™ä¸º:</p>
<ul>
<li>æœªåˆå§‹åŒ–çš„/æœªè¢«ä½¿ç”¨çš„/æœªä¸é›†åˆç»‘å®šçš„ç¬¦å·
<ul>
<li>æœªè¢«ç»‘å®šçš„<code>int</code> <code>string</code>å‚æ•°</li>
<li>æœªè¢«ä½¿ç”¨çš„ database ç±»å‹çš„å‚æ•°</li>
<li>å‡½æ•°ä½“æœ‰è¯­å¥ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•è¿”å›è¯­å¥</li>
</ul>
</li>
<li>åœ¨å–éè¿ç®—å—ä¸­è¿›è¡Œç»‘å®šçš„ç¬¦å·
<ul>
<li>ä¾‹å¦‚ <code>!(__tmp = 1)</code>ï¼Œ<code>__tmp</code>ä¼šè¢«è®¤ä¸ºæ˜¯æœªç»‘å®šçš„</li>
<li>åœ¨å–éè¿ç®—å—ä¸­è°ƒç”¨ inline å‡½æ•°æˆ–æ•°æ®æ„é€ å‡½æ•°</li>
</ul>
</li>
</ul>
<h4 id="1-æœªä½¿ç”¨çš„-databaseåŸºç¡€ç±»å‹å‚æ•°">1. æœªä½¿ç”¨çš„ database/åŸºç¡€ç±»å‹å‚æ•°</h4>
<p>å‡½æ•°ä»£ç å—ä¸­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè¯­å¥åˆ†æ”¯æ²¡æœ‰ä½¿ç”¨å‚æ•°ä¸­çš„<code>database</code>æˆ–è€…åŸºç¡€ç±»å‹å‚æ•°ï¼Œåˆ™ä¸€å®šä¼šå¯¼è‡´<code>ungrounded</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">test</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">^^</span><span class="w">          </span><span class="o">^</span><span class="w">       </span><span class="o">^</span><span class="w">                  </span><span class="o">^^</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Error</span>: <span class="nc">ungrounded</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="s">&#34;db, a, b&#34;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">branch</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>ç¼–è¯‘å™¨ä¼šæç¤ºåœ¨å“ªä¸€æ¡æ‰§è¡Œåˆ†æ”¯ä¸­å­˜åœ¨ unused paramemterï¼Œæ ¹æ®æç¤ºæ£€æŸ¥å¯¹åº”çš„æ‰§è¡Œè·¯å¾„ï¼Œè¡¥å…¨å¯¹ parameter çš„çº¦æŸå³å¯ã€‚</p>
<p>å­˜åœ¨æŸäº›å‡½æ•°ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå‚æ•°è™½ç„¶æ˜¯åŸºç¡€ç±»å‹ï¼Œä½†æ˜¯ä¼ å…¥çš„éƒ½æ˜¯å­—é¢é‡ï¼Œé‚£è¿™æ—¶å¦‚æœé”™è¯¯åœ°æŠ¥å‡ºäº†<code>ungrounded</code>ï¼Œå¯ä»¥ç»™è¯¥å‡½æ•°æ·»åŠ <code>@inline</code>æ³¨è§£ï¼Œæ¥é¿å…é”™è¯¯çš„çº¦æŸæ£€æµ‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="no">XXX</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">xxx</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">xx</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">attr</span><span class="p">.</span><span class="n">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="s">&#34;pattern&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                               </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="err">ä½¿ç”¨äº†å­—é¢é‡</span><span class="p">,</span><span class="w"> </span><span class="err">æ·»åŠ </span><span class="o">@</span><span class="n">inlineæ¥é€šè¿‡æ£€æµ‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="2-å‡½æ•°ä½“æœ‰è¯­å¥çš„æƒ…å†µä¸‹æ— è¿”å›è¯­å¥">2. å‡½æ•°ä½“æœ‰è¯­å¥çš„æƒ…å†µä¸‹æ— è¿”å›è¯­å¥</h4>
<p>GÃ¶delScript å…è®¸ä¸€ä¸ªå‡½æ•°ä½“ä¸åŒ…å«ä»»ä½•è¯­å¥ï¼Œå³ç©ºå‡½æ•°ä½“ã€‚ä½†æ˜¯å¦‚æœå‡½æ•°ä½“ä¸­æœ‰å…¶ä»–è¯­å¥ï¼Œåˆ™ GÃ¶delScript ä¼šè¦æ±‚å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªè¿”å›è¯­å¥ï¼Œå¦åˆ™å°±ä¼šå‡ºç° ungrounded errorã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="o">^^</span><span class="w"> </span><span class="err">æ²¡æœ‰è¯­å¥ï¼Œå¯ä»¥é€šè¿‡ç¼–è¯‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="err">æœ‰è¯­å¥çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è¿”å›è¯­å¥ï¼Œ</span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3-å–éè¿ç®—å—ä¸­ä½¿ç”¨-inline-å‡½æ•°æˆ–æ•°æ®æ„é€ å‡½æ•°">3. å–éè¿ç®—å—ä¸­ä½¿ç”¨ inline å‡½æ•°æˆ–æ•°æ®æ„é€ å‡½æ•°</h4>
<p>ä¸Šæ–‡æåˆ°äº†å¯ä»¥é€šè¿‡<code>@inline</code>æ³¨è§£æ¥è§„é¿ ungrounded errorã€‚ä½†æ˜¯å¦‚æœåœ¨å–éè¿ç®—ä¸­ä½¿ç”¨äº†å«æœ‰è¯¥æ³¨è§£çš„å‡½æ•°ï¼Œåˆ™å¿…ç„¶ä¼šå¯¼è‡´ ungrounded errorã€‚</p>
<p>åŒæ ·ï¼Œæ•°æ®æ„é€ å‡½æ•°å®é™…çš„ä½œç”¨å°±æ˜¯å¯¹ä¸€ä¸ªä¸´æ—¶ä¸­é—´å˜é‡è¿›è¡Œç»‘å®šï¼Œä½†æ˜¯è¿™ä¼šç›´æ¥å¯¼è‡´ ungrounded errorã€‚
æ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨å–éè¿ç®—å—ä¸­ä½¿ç”¨ inline å‡½æ•°æˆ–è€…æ•°æ®æ„é€ å‡½æ•°ï¼Œå¿…ç„¶ä¼šå¯¼è‡´ ungrounded errorï¼Œç¼–è¯‘å™¨ä¼šå¯¹æ‰€æœ‰ç±»ä¼¼çš„æƒ…å†µç›´æ¥æŠ¥é”™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">0</span><span class="p">}))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">for_test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">for_test</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^</span><span class="w"> </span><span class="err">å–éè¿ç®—ä¸­å­˜åœ¨</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="err">å‡½æ•°ï¼Œ</span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="4-å¯¹é“¾å¼è°ƒç”¨çš„å–éè¿ç®—">4. å¯¹é“¾å¼è°ƒç”¨çš„å–éè¿ç®—</h4>
<p>GÃ¶delScript æœªå¯¹è¯¥æƒ…å†µæ‰§è¡Œ<code>ungrounded</code>æ£€æµ‹ï¼Œä½†æ˜¯è¯¥å†™æ³•ä¼šå¯¼è‡´åœ¨ SoufflÃ© ä¸­æŠ¥<code>ungrounded</code>é”™è¯¯:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">get_field</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">Field</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">field</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">field</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å…¶ä¸­:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">!</span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>å®é™…ä¼šè¢«ç¿»è¯‘ä¸ºç±»ä¼¼å¦‚ä¸‹çš„ SoufflÃ© ä»£ç ç‰‡æ®µ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">!</span><span class="p">(</span><span class="n">__tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">Field_getLocation</span><span class="p">(</span><span class="n">__tmp</span><span class="p">,</span><span class="w"> </span><span class="n">__tmp_1</span><span class="p">),</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">__tmp_4</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">^^^^^</span><span class="w">                                   </span><span class="o">^^^^^^^</span><span class="w">
</span></span></span></code></pre></div><p>å…¶ä¸­ç”¨äºä¸­é—´å­˜å‚¨çš„å˜é‡åœ¨<code>!(...)</code>ä¸­è¢«ç»‘å®šï¼Œä½†æ˜¯ç”±äºå–éæ“ä½œç¬¦ï¼Œè¿™ä¸ªç»‘å®šè¢«è®¤ä¸ºæ˜¯å‡è®¾çš„ï¼Œä½†æ˜¯<code>__tmp</code>,<code>__tmp_1</code>å´è¢«è®¤ä¸ºæ˜¯è¢«å£°æ˜å‡ºæ¥æ•´ä¸ªè¯­å¥èŒƒå›´å†…å¯è§çš„å˜é‡ï¼Œä»è€Œå¯¼è‡´<code>ungrounded</code>ã€‚</p>
<p>å¯ä»¥é‡‡å–å£°æ˜ä¸­é—´å˜é‡æ¥ä½ä¸­é—´ç»“æœçš„æ–¹å¼æ¥é¿å…å–éè¿ç®—ä¸­çš„ç»‘å®šæ“ä½œ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">get_field</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">Field</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">field</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">field</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æŸ¥è¯¢ç¤ºä¾‹">æŸ¥è¯¢ç¤ºä¾‹</h2>
<h3 id="java">Java</h3>
<h4 id="æœªä½¿ç”¨æ–¹æ³•">æœªä½¿ç”¨æ–¹æ³•</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// find unused methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">unused_method</span><span class="p">(</span><span class="n">unused</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="n">getCaller</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="n">getSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">unused_method</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="ç±»ç»§æ‰¿å…³ç³»">ç±»ç»§æ‰¿å…³ç³»</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Find all class and the inheritances
</span></span></span><span class="line"><span class="cl"><span class="sd"> * including parent class inheritance and ancestor class inheritance
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">class_hierarchy</span><span class="p">(</span><span class="n">className</span><span class="w"> </span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">superClassName</span><span class="w"> </span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">ancestor</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getAnAncestorClass</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">superClassName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestor</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">class_hierarchy</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="ç±»çš„æ‰€æœ‰æ–¹æ³•ä¿¡æ¯">ç±»çš„æ‰€æœ‰æ–¹æ³•ä¿¡æ¯</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Find all methods of the class
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">methods</span><span class="p">(</span><span class="n">className</span><span class="w"> </span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodName</span><span class="w"> </span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getAllMethods</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">methodName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">methods</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="python">Python</h3>
<h4 id="è·å–å‡½æ•°åœˆå¤æ‚åº¦">è·å–å‡½æ•°åœˆå¤æ‚åº¦</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Get cyclomatic complexity of functions
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name   function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param value  cyclomatic complexity of function
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param path   path of file including this function
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sline  function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param eline  function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getCyclomaticComplexity</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">value</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">path</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">eline</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// get metric function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MetricFunction</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">eline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">getCyclomaticComplexity</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ³¨é‡Šç‡ç»Ÿè®¡">æ³¨é‡Šç‡ç»Ÿè®¡</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">CombineElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">PythonDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of total public element
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">default_db</span><span class="p">()).</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get public elements with Docstring comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">withDocstringCommentElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DocstringComment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentableElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of public elements with Docstring comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicDocumentedElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">withDocstringCommentElement</span><span class="p">().</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">withPublicDocumentedBelowElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Comment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentedClassOrFunctionElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of public element with single line comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicDocumentedBelowElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">withPublicDocumentedBelowElement</span><span class="p">().</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// calculate documented percentage
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getDocumentedPercentage</span><span class="p">(</span><span class="n">documentedPercentage</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicElement</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicDocumentedElement</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicDocumentedBelowElement</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">documentedPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">documentedPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">getDocumentedPercentage</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="å‡½æ•°æ³¨é‡Šæƒ…å†µ">å‡½æ•°æ³¨é‡Šæƒ…å†µ</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">CombineElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">PythonDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">).</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmp</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">).</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmp</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">hasComment</span><span class="p">(</span><span class="n">e</span>: <span class="nc">PublicVisitedElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DocstringComment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentableElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Comment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentedClassOrFunctionElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Get comment of each public element
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param type          public visited element type
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name          public visited element name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath      file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sline         element start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param eline         element end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param isCommented   if is commented
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">output_result</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">type</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">eline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">isCommented</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getType</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">eline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasComment</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isCommented</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">hasComment</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isCommented</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">output_result</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="javascript">JavaScript</h3>
<h4 id="ast-print">AST Print</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * print AST
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath          file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentId          parent node ID
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentKind        parent node kind
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentStartLine   parent node start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentEndLine     parent node end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childId           child node ID
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childKind         child node kind
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childStartLine    child node start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childEndLine      child node end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param index             child node index
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentId</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentKind</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentEndLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childId</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childKind</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childEndLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">index</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">child</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">parentSyntaxKind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SyntaxKind</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">childSyntaxKind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SyntaxKind</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">parentLocation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Location</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">childLocation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Location</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">file</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">child</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentSyntaxKind</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getKind</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childSyntaxKind</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">getKind</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentKind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentSyntaxKind</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childKind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childSyntaxKind</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">getIndex</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getLocation</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getLocation</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getFile</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="åœˆå¤æ‚åº¦">åœˆå¤æ‚åº¦</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavascriptDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Output the cyclomatic complexity of each function
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath      file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param functionName  function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param complexity    cyclomatic complexity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param startLine     function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param endLine       function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">functionName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">complexity</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">startLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">endLine</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">FunctionLikeDeclaration</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">complexity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">functionName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">startLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">endLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="change-effect">Change Effect</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavascriptDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getACallerFunction</span><span class="p">(</span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w"> </span><span class="n">callerFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">mayInvokeExpression</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MayInvokeExpression</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mayInvokeExpression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getACallSite</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">callerFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mayInvokeExpression</span><span class="p">.</span><span class="n">getEnclosingFunction</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getAnEffectedFunction</span><span class="p">(</span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getACallerFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">callerFunction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">FunctionLikeDeclaration</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getACallerFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">callerFunction</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">getAnEffectedFunction</span><span class="p">(</span><span class="n">callerFunction</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Query the effected functions according to the changed lines.
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param function              the changed function id
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param signature             the changed function signature
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param functionPath          the changed function file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param startLine             the changed function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param endLine               the changed function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedFunction      the effected function id
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedSignature     the effected function signature
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedFunctionPath  the effected function file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedStartLine     the effected function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedEndLine       the effected function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">signature</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">functionPath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">startLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">endLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedSignature</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedFunctionPath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedEndLine</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getAnEffectedFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">symbol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getSymbol</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">effectedSymbol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">.</span><span class="n">getSymbol</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">effectedLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">.</span><span class="n">getLocation</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">symbol</span><span class="p">.</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedSymbol</span><span class="p">.</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">functionPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">startLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">endLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedFunctionPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="xml">XML</h3>
<h4 id="è·å–-bean">è·å– bean</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;target&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;bean&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="kr">yield</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;entry&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;property&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">XmlDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get class name
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getClassName</span><span class="p">(</span><span class="n">bean</span>: <span class="nc">BeanXmlElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">bean</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;class&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get key
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getKey</span><span class="p">(</span><span class="n">e</span>: <span class="nc">EntryXmlElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;key&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// output value and class info of the bean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">output1</span><span class="p">(</span><span class="n">className</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">pName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">kName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getClassName</span><span class="p">(</span><span class="n">bean</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bean</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getParent</span><span class="p">().</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">pName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">kName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getKey</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">output1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="pom">POM</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;dependency&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;groupId&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;version&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;artifactId&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlFile</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlFile</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">getFileName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;pom.xml&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">f</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">file_name</span>: <span class="nc">f</span><span class="p">.</span><span class="n">file_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">relative_path</span>: <span class="nc">f</span><span class="p">.</span><span class="n">relative_path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// output relative path of the file, referenced jar name and version
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">fileName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m3</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PomFile</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e1</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GroupElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e2</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">VersionElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e3</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c1</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c2</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c3</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DependencyElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e1</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">getText</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e2</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e2</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">getText</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e3</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e3</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c3</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c3</span><span class="p">.</span><span class="n">getText</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="rpc">RPC</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// select XmlElement containing &#34;mobileService&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;mobileService&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">getServiceBeanValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;serviceBean&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// select XmlElement containing &#34;sofa:extension&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;sofa:extension&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">value</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">ancestor</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getAnAncestor</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getServiceBeanValue</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="go">Go</h3>
<h4 id="è·å–æ‰€æœ‰æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯">è·å–æ‰€æœ‰æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name          file name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param funcCount     function/method quantity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param totallines    total lines of file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param codelines     code line of file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param commentlines  comment line of fine
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param md5           md5 of this file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sha256        sha256 of this file
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">funcCount</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">totallines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">codelines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">commentlines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">md5</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sha256</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">funcCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getFunctionCount</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">md5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getMd5Sum</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getSha256Sum</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">totallines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfTotalLines</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">codelines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfCodeLines</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">commentlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfCommentLines</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="è·å–å‡½æ•°åŠå…¶å…³è”çš„æ³¨é‡Š">è·å–å‡½æ•°åŠå…¶å…³è”çš„æ³¨é‡Š</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Define a predicate called &#39;out&#39; with parameters fileName, funcName, funcComment, and signature
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">fileName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">funcName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">funcComment</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">signature</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Check if there exists a Function object &#39;func&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the name of the file the function belongs to and assign it to the variable &#39;fileName&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getBelongsFile</span><span class="p">().</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the name of the function and assign it to the variable &#39;funcName&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">funcName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the associated comment string for the function and assign it to the variable &#39;funcComment&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">funcComment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getAssociatedCommentString</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the function type signature and assign it to the variable &#39;signature&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getFunctionTypeSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="è·å–å‡½æ•°åœˆå¤æ‚åº¦-1">è·å–å‡½æ•°åœˆå¤æ‚åº¦</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name: file name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param func: function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param cmplx: function cyclomatic complexity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sl,el,sc,ec: function location info
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">func</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">cmplx</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">sl</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">el</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GoFile</span><span class="p">(</span><span class="n">default_db</span><span class="p">()),</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">!</span><span class="n">f</span><span class="p">.</span><span class="n">isAutoGenereatedFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">f</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">function</span><span class="p">.</span><span class="n">getBelongsFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cmplx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">el</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æŸ¥è¯¢è°ƒè¯•å’Œä¼˜åŒ–æŠ€å·§">æŸ¥è¯¢è°ƒè¯•å’Œä¼˜åŒ–æŠ€å·§</h2>
<p>è¿è¡Œ GÃ¶delScript è„šæœ¬çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå‡ºç°è¿è¡Œæ—¶é—´è¶…é•¿çš„é—®é¢˜ï¼Œè¿™é‡Œæä¾›ä¸€äº›åŸºæœ¬åˆ¤åˆ«æ–¹æ³•å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 id="schema-ä¼ å‚å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§">Schema ä¼ å‚å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</h3>
<p>å‡½æ•°ä¼ å‚åœ¨æ²¡æœ‰<code>@inline</code>æ³¨è§£çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤æ˜¯ä½œä¸ºâ€œé™å®šâ€æ¡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¼ å…¥å€¼å­˜åœ¨ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>get</code>è·å–åˆ°ä¸€ä¸ª<code>Class</code>ç±»å‹çš„ä¼ å…¥å‚æ•°ï¼Œä½†æ˜¯å®é™…ä¸Šæœ€ç»ˆçš„ç¼–è¯‘ç»“æœä¼šç±»ä¼¼ä¸‹é¢çš„ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å®é™…çš„ç¼–è¯‘ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å®é™…ä¸Šæ˜¯è¦å…ˆæ‹¿ Class å…¨é›†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">__temp_class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__temp_class</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>æ‰€ä»¥åœ¨ä¼ å‚ä¸­ schema ç±»å‹å¾ˆå¤šæ—¶ï¼Œä¼šå‡ºç°å¤šä¸ª schema å…¨é›†åšç¬›å¡å°”ç§¯çš„æƒ…å†µï¼Œç©ºé—´å’Œæ—¶é—´å¼€é”€æ€¥å‰§å¢åŠ ã€‚
è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼ŒåŠ ä¸€ä¸ª<code>@inline</code>æ³¨è§£å°±å¯ä»¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// inline æ³¨è§£ä¼šå¼ºè¡Œåœ¨ä»£ç ç”Ÿæˆé˜¶æ®µå°†å‡½æ•°å†…è”åˆ°è¯­å¥ä¸­ï¼Œé¿å…å¤šæ¬¡åŠ è½½è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1">// å®é™…çš„ç¼–è¯‘ç»“æœç±»ä¼¼äº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="å¤šå±‚-for-å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§">å¤šå±‚ for å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</h3>
<p>åœ¨ä¸€äº›æƒ…å†µä¸‹ä¸å¯é¿å…çš„ä¼šä½¿ç”¨éå¸¸å¤šå±‚æ•°çš„ for æ¥åŠ è½½å¤šè¡¨è¿›è¡Œè”æŸ¥ï¼Œå¯¼è‡´ç¬›å¡å°”ç§¯ä¸¥é‡è†¨èƒ€ã€‚å¯ä»¥é€šè¿‡æå‰å‡å°‘ (è¿‡æ»¤) é›†åˆå¤§å°çš„æ–¹å¼æ¥ç¼©å‡ç¬›å¡å°”ç§¯ç»“æœæ•°é‡ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getByIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Expression</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Expression</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Parameter</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getIndex</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œe, p åšç¬›å¡å°”ç§¯ï¼Œå¯¼è‡´ä¸­é—´è¿‡ç¨‹å ç”¨æ—¶é—´å¤ªé•¿ã€‚
i å®é™…ä¸Šæ˜¯ä» p çš„ä¸€ä¸ªæ–¹æ³•ä¸­å¾—åˆ°çš„é›†åˆï¼Œå¹¶ä¸”åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™ä¸ªé›†åˆéå¸¸å°ï¼Œè¿œæ¯” Parameter å…¨é›†å°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠ i é›†åˆçš„è·å–æŠ½å‡ºæ¥å˜æˆå•ç‹¬çš„å‡½æ•°ï¼Œç”Ÿæˆå°é›†åˆï¼Œé¿å…å¤§é›†åˆä¹‹é—´ç¬›å¡å°”ç§¯è¿ç®—çš„åŒæ—¶ï¼Œè¿˜ä¿è¯äº†ç»“æœçš„ç­‰ä»·:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAllParameterIndex</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Parameter</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getIndex</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getByIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Expression</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Expression</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllParameterIndex</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>e, p çš„ç¬›å¡å°”ç§¯å°±å˜æˆäº† e, i çš„ç¬›å¡å°”ç§¯ï¼Œä»è¿ç®—çš„å±‚é¢æ¥çœ‹ï¼Œç¬›å¡å°”ç§¯å¼€é”€å˜å°ï¼Œ<code>getIndex</code>æ“ä½œä¹Ÿè¢«æå‰äº†ï¼Œè€Œä¸æ˜¯åœ¨åšç¬›å¡å°”ç§¯ä¹‹åè¿›è¡Œï¼Œæ‰€ä»¥æ€§èƒ½å¤§å¹…åº¦æå‡ã€‚</p>
<h3 id="ä¸è¦æ»¥ç”¨inlineå¿…é¡»ç”¨inlineçš„ä¼˜åŒ–ç­–ç•¥">ä¸è¦æ»¥ç”¨<code>@inline</code>/å¿…é¡»ç”¨<code>@inline</code>çš„ä¼˜åŒ–ç­–ç•¥</h3>
<p>inline å‡½æ•°çš„åº•å±‚æœºåˆ¶æ˜¯åœ¨<strong>è°ƒç”¨å¤„å±•å¼€</strong>ï¼Œå¦‚æœè¯¥å‡½æ•°ä¸å­˜åœ¨å¤§é‡çš„ schema ä¼ å‚ï¼Œå¹¶ä¸”åœ¨å¾ˆå¤šä½ç½®éƒ½è¢«è°ƒç”¨ï¼Œinline å¯èƒ½ä¼šå¯¼è‡´<strong>ç¼–è¯‘ç»“æœè†¨èƒ€ä¸”é‡å¤è®¡ç®—æ¬¡æ•°æŒ‡æ•°çº§å¢åŠ </strong>ï¼Œæœ‰æ—¶åè€Œä¸åˆ©äºå‡å°‘è¿è¡Œæ—¶é—´ã€‚
å¦‚æœå­˜åœ¨å¿…é¡»è¦ä½¿ç”¨ inline çš„æƒ…å†µ (æ¯”å¦‚è§„é¿<code>ungrounded</code>)ï¼Œä½†æ˜¯ä½¿ç”¨ä¹‹ååè€Œå‡ºç°è¿è¡Œé€Ÿåº¦å˜æ…¢çš„æƒ…å†µï¼Œå¯ä»¥é‡‡å–å°†å†…åµŒè¯­å¥æ‹†åˆ†ä¸º predicate çš„æ–¹å¼æ¥é¿å…å±•å¼€å¯¼è‡´çš„ç¼–è¯‘ç»“æœè†¨èƒ€ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>getValueByAttributeNameByDefaultValue</code>ä¸ºäº†é¿å…<code>attributeName</code>è¢«è¯†åˆ«ä¸º<code>ungrounded</code>æ‰€ä»¥æ ‡æ³¨<code>inline</code>ï¼Œåç»­åœ¨ if åˆ†æ”¯ä¸­æ·»åŠ äº†ä¸€ä¸ªæ¡ä»¶è¯­å¥ï¼Œä½†æ˜¯å¯¼è‡´äº†æ‰§è¡Œæ—¶é—´ä» 3 ç§’å˜æˆ 35 ç§’ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">XmlElementBase</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c1">// return self.getValueByAttributeName(attributeName)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">      </span><span class="c1">// æ›´æ”¹ä¸ºäº†å¦‚ä¸‹è¯­å¥:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">      </span><span class="kd">let</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œå¢åŠ äº†ä¸€å±‚èµ‹å€¼å’Œä¸€å±‚æ¡ä»¶è¯­å¥ï¼Œåœ¨ä¸‹æ–‡ä¸­ï¼Œè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†æ¥è¿‘ 20 æ¬¡ï¼Œå¯¼è‡´äº†ä»£ç æ¥è¿‘ 20 æ¬¡è¢«é‡å¤å±•å¼€ï¼ŒåŒæ—¶ä¹Ÿé€ æˆäº†æ€§èƒ½å‡ºç°äº†ä¸€ä¸ªæ•°é‡çº§çš„å·®è·ã€‚æ­¤æ—¶å¯ä»¥å°†æ›´æ”¹çš„è¯­å¥æå–å‡ºæ¥ï¼Œç”±äºæå–å‡ºæ¥çš„å‡½æ•°å¹¶æ²¡æœ‰ä½¿ç”¨å¤æ‚ç±»å‹ä½œä¸ºä¼ å‚ï¼Œæ‰€ä»¥ä¸éœ€è¦ inline æ€§èƒ½ä¹Ÿæ²¡æœ‰æŸå¤±ï¼Œæå–ä¹‹åç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">XmlElementBase</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getTransValueByAttributeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getTransValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>è¿™æ ·æ‰§è¡Œæ—¶é—´ä» 35 ç§’å›åˆ° 3 ç§’ï¼Œç¬¦åˆé¢„æœŸã€‚</p>
<h2 id="åœ¨æœ¬æœºä½¿ç”¨æŸ¥è¯¢è„šæœ¬æµç¨‹">åœ¨æœ¬æœºä½¿ç”¨æŸ¥è¯¢è„šæœ¬æµç¨‹</h2>
<p>å‚è§<a href="./3_install_and_run.md">å®‰è£…ã€é…ç½®ã€è¿è¡Œ</a></p>

      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

      
    
        

        
          
        

        
        
      


<footer id="article-footer">
  <time id="article-last-updated" datetime="2024-04-09"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2024-04-09</time>

  
    <a id="article-prev-link" href="/docs/codefuse-query-quickstart-zh/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
    <a id="article-next-link"  href="/docs/codefuse-query-toolchain-zh/">Next <i class="icon icon-next icon-colored"></i></a>
  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ç›®å½•">ç›®å½•</a></li>
    <li><a href="#gÃ¶delscript-åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•">GÃ¶delScript åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•</a>
      <ul>
        <li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
        <li><a href="#åŸºæœ¬ç¨‹åºæ„æˆ">åŸºæœ¬ç¨‹åºæ„æˆ</a></li>
        <li><a href="#åŸºç¡€ç±»å‹å’Œç¼–è¯‘å™¨å†…å»ºå‡½æ•°">åŸºç¡€ç±»å‹å’Œç¼–è¯‘å™¨å†…å»ºå‡½æ•°</a></li>
        <li><a href="#å‡½æ•°">å‡½æ•°</a></li>
        <li><a href="#è¯­å¥">è¯­å¥</a></li>
        <li><a href="#schema">Schema</a></li>
        <li><a href="#æ•°æ®åº“">æ•°æ®åº“</a></li>
        <li><a href="#trait">Trait</a></li>
        <li><a href="#import">Import</a></li>
        <li><a href="#query">Query</a></li>
        <li><a href="#ungrounded-error-æœªèµ‹å€¼æœªç»‘å®šé”™è¯¯">Ungrounded Error: æœªèµ‹å€¼/æœªç»‘å®šé”™è¯¯</a></li>
      </ul>
    </li>
    <li><a href="#æŸ¥è¯¢ç¤ºä¾‹">æŸ¥è¯¢ç¤ºä¾‹</a>
      <ul>
        <li><a href="#java">Java</a></li>
        <li><a href="#python">Python</a></li>
        <li><a href="#javascript">JavaScript</a></li>
        <li><a href="#xml">XML</a></li>
        <li><a href="#go">Go</a></li>
      </ul>
    </li>
    <li><a href="#æŸ¥è¯¢è°ƒè¯•å’Œä¼˜åŒ–æŠ€å·§">æŸ¥è¯¢è°ƒè¯•å’Œä¼˜åŒ–æŠ€å·§</a>
      <ul>
        <li><a href="#schema-ä¼ å‚å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§">Schema ä¼ å‚å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</a></li>
        <li><a href="#å¤šå±‚-for-å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§">å¤šå±‚ for å¯¼è‡´ç¬›å¡å°”ç§¯è¿‡å¤§</a></li>
        <li><a href="#ä¸è¦æ»¥ç”¨inlineå¿…é¡»ç”¨inlineçš„ä¼˜åŒ–ç­–ç•¥">ä¸è¦æ»¥ç”¨<code>@inline</code>/å¿…é¡»ç”¨<code>@inline</code>çš„ä¼˜åŒ–ç­–ç•¥</a></li>
      </ul>
    </li>
    <li><a href="#åœ¨æœ¬æœºä½¿ç”¨æŸ¥è¯¢è„šæœ¬æµç¨‹">åœ¨æœ¬æœºä½¿ç”¨æŸ¥è¯¢è„šæœ¬æµç¨‹</a></li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://github.com/codefuse-ai" target="_blank">
      <i class="icon icon-copyright"></i> 2023-2024 codefuse-ai
    </a>
  </div>

  
  <div id="site-footer-social">

    

    

    
    <a href="https://github.com/codefuse-ai" target="_blank" aria-label="github url">
      <i class="icon icon-github icon-colored"></i>
    </a>
    

    

  </div>

  
  <div id="site-footer-fund">

    

    

  </div>

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://docura.github.io/" target="_blank">Docura</a>
  </div>
</footer>
    






<script type="text/javascript" src="/js/base.min.js"></script>




<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2024-04-09')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>